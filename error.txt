# Capture the current user's context
$UserContext = ([System.Security.Principal.WindowsIdentity]::GetCurrent()).Name

# Set the paths
$msixBundlePath = "C:\Temp\Microsoft.DesktopAppInstaller_8wekyb3d8bbwe.msixbundle"
$taskName = "InstallMSIXDesktopAppInstaller"

# Create the Task Action
$action = New-ScheduledTaskAction -Execute "powershell.exe" -Argument "-Command Add-AppxPackage -Path '$msixBundlePath'"

# Set the Task Trigger for a one-time task
$trigger = New-ScheduledTaskTrigger -At (Get-Date).AddMinutes(1)

# Register the task and complete
Register-ScheduledTask -Action $action -Trigger $trigger -TaskName $taskName -RunLevel Highest -User $UserContext

Write-Host "Task has been created successfully."
